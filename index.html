<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üßß H·ªÜ TH·ªêNG TOOL MD5 ƒêA GIAO DI·ªÜN üßß</title>
    <style>
        /* ƒê·ªäNH NGHƒ®A BI·∫æN M√ÄU S·∫ÆC */
        :root {
            --bg-body: #1a0000;
            --bg-box: rgba(100, 0, 0, 0.95);
            --border-color: #FFD700;
            --text-main: #FFD700;
            --text-sub: #fff;
            --btn-grad1: #FFD700;
            --btn-grad2: #ffae00;
            --btn-text: #B40000;
            --shadow-color: rgba(255, 0, 0, 0.6);
            --font-family: 'Segoe UI', Arial, sans-serif;
        }

        /* THEME HACKER (LC79) */
        body.theme-hacker {
            --bg-body: #050505;
            --bg-box: rgba(0, 25, 0, 0.95);
            --border-color: #00FF00;
            --text-main: #00FF00;
            --text-sub: #00cc00;
            --btn-grad1: #004400;
            --btn-grad2: #00aa00;
            --btn-text: #000;
            --shadow-color: rgba(0, 255, 0, 0.4);
            --font-family: 'Courier New', Courier, monospace;
        }

        /* THEME C√îNG NGH·ªÜ (BETVIP) */
        body.theme-tech {
            --bg-body: #020210;
            --bg-box: rgba(10, 20, 50, 0.95);
            --border-color: #00FFFF;
            --text-main: #00FFFF;
            --text-sub: #b3ffff;
            --btn-grad1: #0055aa;
            --btn-grad2: #00aaff;
            --btn-text: #fff;
            --shadow-color: rgba(0, 255, 255, 0.5);
            --font-family: 'Trebuchet MS', sans-serif;
        }

        /* THEME S√íNG B·∫†C (HITCLUB) */
        body.theme-casino {
            --bg-body: #2b0000;
            --bg-box: rgba(40, 10, 10, 0.95);
            --border-color: #E5C158;
            --text-main: #E5C158;
            --text-sub: #e6e6e6;
            --btn-grad1: #8B0000;
            --btn-grad2: #B22222;
            --btn-text: #E5C158;
            --shadow-color: rgba(229, 193, 88, 0.4);
            --font-family: 'Georgia', serif;
        }

        body { margin: 0; background: var(--bg-body); font-family: var(--font-family); color: var(--text-main); overflow: hidden; display: flex; justify-content: center; align-items: center; height: 100vh; transition: background 0.5s ease; }
        #fireworks { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 1; }
        
        .container { background: var(--bg-box); padding: 30px; border-radius: 20px; border: 3px solid var(--border-color); text-align: center; z-index: 10; width: 90%; max-width: 420px; box-shadow: 0 0 50px var(--shadow-color); display: none; max-height: 90vh; overflow-y: auto; transition: all 0.5s ease; }
        
        h1 { font-size: 20px; margin: 0 0 15px 0; text-shadow: 2px 2px #000; text-transform: uppercase; }
        .sub-text { font-size: 11px; color: var(--text-sub); margin-top: -5px; margin-bottom: 20px; opacity: 0.8; }
        
        input, select { width: 100%; padding: 12px; border-radius: 10px; border: 2px solid var(--border-color); font-size: 14px; text-align: center; margin-bottom: 12px; box-sizing: border-box; background: #fff; color: #000; font-family: var(--font-family); font-weight: bold; }
        
        button { background: linear-gradient(145deg, var(--btn-grad1), var(--btn-grad2)); color: var(--btn-text); border: 1px solid var(--border-color); padding: 14px; font-weight: 900; border-radius: 10px; cursor: pointer; width: 100%; font-size: 15px; box-shadow: 0 4px #000; text-transform: uppercase; transition: 0.2s; margin-bottom: 10px; font-family: var(--font-family); }
        button:active { transform: translateY(2px); box-shadow: 0 2px #000; }
        
        .btn-portal { background: linear-gradient(145deg, #222, #444); color: var(--text-main); border: 1px solid var(--border-color); font-size: 14px; letter-spacing: 1px; }
        
        .link-text { color: var(--text-sub); font-size: 12px; cursor: pointer; text-decoration: underline; display: block; margin-top: 10px; opacity: 0.8; }
        
        .result-box { margin-top: 20px; padding: 20px; background: rgba(0,0,0,0.8); border-radius: 15px; border: 2px dashed var(--border-color); }
        #finalResult { font-size: 50px; font-weight: 900; margin: 5px 0; text-shadow: 0 0 15px var(--shadow-color); }
        
        /* CSS Admin */
        .admin-section { border-top: 2px dashed var(--border-color); margin-top: 15px; padding-top: 15px; text-align: left; font-size: 13px; color: var(--text-sub); }
        .list-item { background: rgba(255,255,255,0.1); padding: 10px; border-radius: 8px; margin-bottom: 10px; display: flex; justify-content: space-between; align-items: center; border: 1px solid #555; }
        .list-item.banned { border-color: #ff3333; background: rgba(255, 0, 0, 0.2); }
        .btn-small { padding: 5px 8px; font-size: 9px; width: auto; box-shadow: none; margin: 2px; border: none; border-radius: 5px; color: #fff; }
        .btn-ban { background: #ff3333; }
        .btn-unban { background: #00FF00; color: #000; }
        .btn-revoke { background: #ff9900; }
        .btn-del { background: #555; }
        
        ::-webkit-scrollbar { width: 5px; }
        ::-webkit-scrollbar-thumb { background: var(--border-color); border-radius: 10px; }
    </style>
</head>
<body>
    <canvas id="fireworks"></canvas>

    <div id="loginBox" class="container" style="display: block;">
        <h1>üßß H·ªÜ TH·ªêNG TOOL PRO üßß</h1>
        <input type="text" id="loginUser" placeholder="T√äN ƒêƒÇNG NH·∫¨P">
        <input type="password" id="loginPass" placeholder="M·∫¨T KH·∫®U">
        <div id="loginError" style="color:#ff3333; font-size:12px; margin-bottom:10px; display:none;"></div>
        <button onclick="handleLogin()">V√ÄO H·ªÜ TH·ªêNG</button>
        <span class="link-text" onclick="showForm('registerBox')">Ch∆∞a c√≥ t√†i kho·∫£n? ƒêƒÉng k√Ω</span>
    </div>

    <div id="registerBox" class="container">
        <h1>üßß ƒêƒÇNG K√ù M·ªöI üßß</h1>
        <input type="text" id="regUser" placeholder="T√äN ƒêƒÇNG NH·∫¨P M·ªöI">
        <input type="password" id="regPass" placeholder="M·∫¨T KH·∫®U M·ªöI">
        <button onclick="handleRegister()">T·∫†O T√ÄI KHO·∫¢N</button>
        <span class="link-text" onclick="showForm('loginBox')">Quay l·∫°i ƒêƒÉng nh·∫≠p</span>
    </div>

    <div id="adminBox" class="container">
        <h1>‚öôÔ∏è B·∫¢NG ƒêI·ªÄU KHI·ªÇN ADMIN ‚öôÔ∏è</h1>
        
        <div class="admin-section">
            <h3 style="margin-top:0; color:var(--text-main);">1. T·∫†O M√É KEY VIP</h3>
            <input type="text" id="newKeyName" placeholder="M√£ Key (VD: VIP999)">
            <input type="number" id="keyDur" placeholder="Th·ªùi h·∫°n">
            <select id="keyUnit"><option value="hour">Gi·ªù</option><option value="day">Ng√†y</option></select>
            <button onclick="generateKey()" style="background:#00FF00; color:#000;">T·∫†O KEY M·ªöI</button>
            <div id="keyNotice" style="font-size:11px; color:#00FF00;"></div>
        </div>

        <div class="admin-section">
            <h3 style="color:var(--text-main);">2. DANH S√ÅCH KEY ƒê√É T·∫†O</h3>
            <div id="keyListArea"></div>
        </div>

        <div class="admin-section">
            <h3 style="color:var(--text-main);">3. QU·∫¢N L√ù TH√ÄNH VI√äN</h3>
            <div id="userListArea"></div>
        </div>

        <button onclick="location.reload()" style="background:#555; color:#fff; margin-top:15px;">ƒêƒÇNG XU·∫§T</button>
    </div>

    <div id="keyBox" class="container">
        <h1>üîë K√çCH HO·∫†T T√ÄI KHO·∫¢N üîë</h1>
        <p class="sub-text" id="userWelcome"></p>
        <input type="text" id="keyInput" placeholder="NH·∫¨P M√É KEY C·ª¶A B·∫†N">
        <button onclick="activateKey()">K√çCH HO·∫†T KEY</button>
        <button onclick="location.reload()" style="background:#444; color:#fff; font-size:12px;">ƒêƒÇNG XU·∫§T</button>
    </div>

    <div id="portalBox" class="container">
        <h1>üéÆ CH·ªåN C·ªîNG GAME üéÆ</h1>
        <p id="expireLabel" style="font-size:11px; color:#00FF00; margin-top:-10px; margin-bottom:15px;"></p>
        <button class="btn-portal" style="border-color:#00FF00; color:#00FF00;" onclick="selectPortal('LC79', 0x1C79, 'theme-hacker')">üíª C·ªîNG LC79 (MD5)</button>
        <button class="btn-portal" style="border-color:#00FFFF; color:#00FFFF;" onclick="selectPortal('BETVIP', 0xBE77, 'theme-tech')">üåå C·ªîNG BETVIP (MD5)</button>
        <button class="btn-portal" style="border-color:#E5C158; color:#E5C158;" onclick="selectPortal('HITCLUB', 0x417C, 'theme-casino')">üé∞ C·ªîNG HITCLUB (MD5)</button>
        <button class="btn-portal" style="border-color:#FFD700; color:#FFD700;" onclick="selectPortal('SAO789', 0x7890, '')">‚≠ê C·ªîNG SAO789 (MD5)</button>
        <button onclick="location.reload()" style="background:#444; color:#fff; font-size:12px; margin-top:10px;">ƒêƒÇNG XU·∫§T</button>
    </div>

    <div id="toolBox" class="container">
        <h1 id="toolTitle">TOOL MD5</h1>
        <div class="sub-text" id="portalSubText"></div>
        <input type="text" id="hashInput" placeholder="D√ÅN M√É MD5 (32 K√ù T·ª∞)">
        <button onclick="analyzeMD5Pro()">üß® PH√ÇN T√çCH K·∫æT QU·∫¢ üß®</button>
        
        <div class="result-box">
            <div id="percentLabel" style="font-weight:bold; font-size:14px;">CH·ªú D·ªÆ LI·ªÜU...</div>
            <div id="finalResult">---</div>
        </div>
        <button onclick="goBackToPortal()" style="background:#555; color:#fff; margin-top:15px; font-size:14px; border-color:#555;">ƒê·ªîI C·ªîNG GAME</button>
    </div>

    <script>
        // --- H·ªÜ TH·ªêNG C∆† S·ªû D·ªÆ LI·ªÜU (LOCALSTORAGE) ---
        let usersDB = JSON.parse(localStorage.getItem("sys_users")) || {};
        let keysDB = JSON.parse(localStorage.getItem("sys_keys")) || {};
        let currentUser = "";
        let currentPortal = "";
        let currentSalt = 0;
        let usedHashes = new Set();

        function saveData() {
            localStorage.setItem("sys_users", JSON.stringify(usersDB));
            localStorage.setItem("sys_keys", JSON.stringify(keysDB));
        }

        function showForm(id) {
            document.querySelectorAll('.container').forEach(f => f.style.display = 'none');
            document.getElementById(id).style.display = 'block';
        }

        function showError(msg) {
            const err = document.getElementById('loginError');
            err.innerText = msg;
            err.style.display = 'block';
        }

        // --- ƒêƒÇNG K√ù / ƒêƒÇNG NH·∫¨P ---
        function handleRegister() {
            const u = document.getElementById('regUser').value.trim().toLowerCase();
            const p = document.getElementById('regPass').value.trim();
            if(!u || !p) { alert("ƒêi·ªÅn ƒë·ªß th√¥ng tin!"); return; }
            if(u === "admin" || usersDB[u]) { alert("T√†i kho·∫£n ƒë√£ t·ªìn t·∫°i!"); return; }
            usersDB[u] = { pass: p, banned: false, expire: 0 };
            saveData(); alert("ƒêƒÉng k√Ω th√†nh c√¥ng!"); showForm('loginBox');
        }

        function handleLogin() {
            const u = document.getElementById('loginUser').value.trim().toLowerCase();
            const p = document.getElementById('loginPass').value.trim();
            document.getElementById('loginError').style.display = 'none';

            if(u === "admin" && p === "thedung213") {
                currentUser = "admin"; 
                renderAdminKeys();
                renderAdminUsers(); 
                showForm('adminBox'); return;
            }

            if(usersDB[u] && usersDB[u].pass === p) {
                if(usersDB[u].banned) { showError("‚õî T√ÄI KHO·∫¢N C·ª¶A B·∫†N ƒê√É B·ªä KH√ìA!"); return; }
                currentUser = u;
                document.getElementById('userWelcome').innerText = "T√†i kho·∫£n: " + u;
                if(usersDB[u].expire > new Date().getTime()) {
                    document.getElementById('expireLabel').innerText = "H·∫°n d√πng t·ªõi: " + new Date(usersDB[u].expire).toLocaleString();
                    showForm('portalBox');
                } else { showForm('keyBox'); }
            } else { showError("Sai t√†i kho·∫£n ho·∫∑c m·∫≠t kh·∫©u!"); }
        }

        // --- ADMIN: QU·∫¢N L√ù KEY ---
        function generateKey() {
            const name = document.getElementById('newKeyName').value.trim();
            const dur = parseInt(document.getElementById('keyDur').value);
            const unit = document.getElementById('keyUnit').value;
            if(!name || !dur) return;
            const ms = dur * (unit === 'hour' ? 3600000 : 86400000);
            keysDB[name] = { dur: ms, usedBy: "" };
            saveData();
            document.getElementById('keyNotice').innerText = "ƒê√£ l∆∞u Key: " + name;
            renderAdminKeys();
            setTimeout(()=> document.getElementById('keyNotice').innerText="", 3000);
        }

        function renderAdminKeys() {
            const area = document.getElementById('keyListArea');
            area.innerHTML = "";
            let count = 0;
            for(let kname in keysDB) {
                count++;
                const kdata = keysDB[kname];
                const div = document.createElement('div');
                div.className = "list-item";
                
                let statusHtml = kdata.usedBy === "" 
                    ? `<span style="color:#00FF00;">Ch∆∞a d√πng</span>` 
                    : `<span style="color:#FFD700;">ƒê√£ n·∫°p b·ªüi: ${kdata.usedBy}</span>`;
                
                const info = document.createElement('div');
                info.innerHTML = `<b>${kname}</b> <br><span style="font-size:10px;">${statusHtml} | H·∫°n: ${kdata.dur/3600000}H</span>`;
                
                const btnBox = document.createElement('div');
                const btnDel = document.createElement('button');
                btnDel.className = "btn-small btn-del";
                btnDel.innerText = "X√ìA KEY";
                btnDel.onclick = () => deleteKey(kname);
                
                btnBox.appendChild(btnDel);
                div.appendChild(info); div.appendChild(btnBox); area.appendChild(div);
            }
            if(count === 0) area.innerHTML = "<i>Ch∆∞a t·∫°o m√£ Key n√†o.</i>";
        }

        function deleteKey(kname) {
            if(confirm("B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a Key: " + kname + " ?")) {
                delete keysDB[kname];
                saveData(); renderAdminKeys();
            }
        }

        // --- ADMIN: QU·∫¢N L√ù USER ---
        function renderAdminUsers() {
            const area = document.getElementById('userListArea');
            area.innerHTML = "";
            let count = 0;
            const now = new Date().getTime();
            for(let uname in usersDB) {
                count++;
                const udata = usersDB[uname];
                const div = document.createElement('div');
                div.className = "list-item " + (udata.banned ? "banned" : "");
                
                const hasVip = udata.expire > now;
                const info = document.createElement('div');
                info.innerHTML = `<b>${uname}</b> <br><span style="font-size:10px; color:#aaa;">H·∫øt h·∫°n: ${hasVip ? new Date(udata.expire).toLocaleString() : 'ƒê√£ h·∫øt/Ch∆∞a n·∫°p'}</span>`;
                
                const btnBox = document.createElement('div');
                
                // N√∫t Ban / Unban
                const btnBan = document.createElement('button');
                btnBan.className = "btn-small " + (udata.banned ? "btn-unban" : "btn-ban");
                btnBan.innerText = udata.banned ? "M·ªû KH√ìA" : "KH√ìA";
                btnBan.onclick = () => toggleBan(uname);
                btnBox.appendChild(btnBan);

                // N√∫t Thu h·ªìi VIP (Ch·ªâ hi·ªán n·∫øu ƒëang c√≤n h·∫°n)
                if(hasVip) {
                    const btnRevoke = document.createElement('button');
                    btnRevoke.className = "btn-small btn-revoke";
                    btnRevoke.innerText = "X√ìA VIP";
                    btnRevoke.onclick = () => revokeUserVip(uname);
                    btnBox.appendChild(btnRevoke);
                }

                div.appendChild(info); div.appendChild(btnBox); area.appendChild(div);
            }
            if(count === 0) area.innerHTML = "<i>Ch∆∞a c√≥ th√†nh vi√™n n√†o.</i>";
        }

        function toggleBan(uname) {
            usersDB[uname].banned = !usersDB[uname].banned; saveData(); renderAdminUsers();
        }

        function revokeUserVip(uname) {
            if(confirm("X√≥a h·∫°n s·ª≠ d·ª•ng VIP c·ªßa t√†i kho·∫£n: " + uname + "?")) {
                usersDB[uname].expire = 0;
                saveData(); renderAdminUsers();
            }
        }

        // --- K√çCH HO·∫†T KEY & CH·ªåN C·ªîNG ---
        function activateKey() {
            const k = document.getElementById('keyInput').value.trim();
            if(!keysDB[k]) { alert("Key kh√¥ng h·ª£p l·ªá ho·∫∑c ƒë√£ b·ªã x√≥a!"); return; }
            if(keysDB[k].usedBy !== "") { alert("Key n√†y ƒë√£ ƒë∆∞·ª£c s·ª≠ d·ª•ng!"); return; }
            const expireTime = new Date().getTime() + keysDB[k].dur;
            keysDB[k].usedBy = currentUser; usersDB[currentUser].expire = expireTime;
            saveData(); alert("K√≠ch ho·∫°t th√†nh c√¥ng!");
            document.getElementById('expireLabel').innerText = "H·∫°n d√πng t·ªõi: " + new Date(expireTime).toLocaleString();
            showForm('portalBox');
        }

        function selectPortal(name, salt, themeClass) {
            currentPortal = name; currentSalt = salt;
            document.body.className = themeClass;
            
            let icon = "üßß";
            if(themeClass === 'theme-hacker') icon = "üíª";
            if(themeClass === 'theme-tech') icon = "üåå";
            if(themeClass === 'theme-casino') icon = "üé∞";
            
            document.getElementById('toolTitle').innerText = `${icon} TOOL MD5: ${name} ${icon}`;
            document.getElementById('portalSubText').innerText = `ƒêang ƒë·ªìng b·ªô h√≥a d·ªØ li·ªáu Server ${name}...`;
            document.getElementById('finalResult').innerText = "---";
            document.getElementById('percentLabel').innerText = "CH·ªú K·∫æT N·ªêI...";
            document.getElementById('hashInput').value = "";
            showForm('toolBox');
        }

        function goBackToPortal() {
            document.body.className = ''; showForm('portalBox');
        }

        function analyzeMD5Pro() {
            const hash = document.getElementById('hashInput').value.trim().toLowerCase();
            if(hash.length !== 32) { alert("D√°n ƒë√∫ng chu·ªói MD5 (32 k√Ω t·ª±)!"); return; }
            
            const uk = currentPortal + "_" + hash;
            if(usedHashes.has(uk)) { alert("M√£ n√†y ƒë√£ ph√¢n t√≠ch ·ªü c·ªïng " + currentPortal + "!"); return; }
            usedHashes.add(uk);

            const seed1 = parseInt(hash.substring(0, 8), 16);
            const score = ((seed1 ^ currentSalt) % 16) + 3; 
            
            const isTai = score >= 11;
            const rate = 55 + (parseInt(hash.substring(16,20), 16) % 33); 

            document.getElementById('percentLabel').innerText = "T·ªà L·ªÜ TH·∫ÆNG: " + rate + "%";
            document.getElementById('finalResult').innerText = isTai ? "T√ÄI" : "X·ªàU";
            
            let colorTai = "var(--text-main)";
            let colorXiu = "#fff";
            if(document.body.className === 'theme-tech') { colorTai = "#00FFFF"; colorXiu = "#FF00FF"; } 
            if(document.body.className === 'theme-hacker') { colorTai = "#00FF00"; colorXiu = "#fff"; } 
            
            document.getElementById('finalResult').style.color = isTai ? colorTai : colorXiu;
            startFireworks();
        }

        // --- PH√ÅO HOA ---
        const canvas = document.getElementById('fireworks');
        const ctx = canvas.getContext('2d');
        let particles = [];
        function resize() { canvas.width = window.innerWidth; canvas.height = window.innerHeight; }
        window.onresize = resize; resize();
        
        function createFirework(x,y) {
            let colors = ['#FFD700', '#FF4444', '#FFFFFF'];
            if(document.body.className === 'theme-hacker') colors = ['#00FF00', '#008800', '#FFFFFF'];
            else if(document.body.className === 'theme-tech') colors = ['#00FFFF', '#0088FF', '#FF00FF'];
            else if(document.body.className === 'theme-casino') colors = ['#FFD700', '#E5C158', '#FF0000'];
            
            for(let i=0; i<35; i++) particles.push({x,y,vx:(Math.random()-0.5)*12,vy:(Math.random()-0.5)*12,life:1,color:colors[Math.floor(Math.random()*colors.length)]});
        }
        function startFireworks() { createFirework(window.innerWidth/2, window.innerHeight/3); }
        function animate() {
            ctx.fillStyle = 'rgba(0,0,0,0.2)'; 
            if(document.body.className === '') ctx.fillStyle = 'rgba(26,0,0,0.2)'; 
            ctx.fillRect(0,0,canvas.width,canvas.height);
            particles.forEach((p,i) => {
                p.x+=p.vx; p.y+=p.vy; p.vy+=0.1; p.life-=0.02;
                if(p.life<=0) particles.splice(i,1);
                ctx.fillStyle=p.color; ctx.globalAlpha=p.life;
                ctx.beginPath(); ctx.arc(p.x,p.y,2.5,0,Math.PI*2); ctx.fill();
            });
            requestAnimationFrame(animate);
        }
        animate();
    </script>
</body>
</html>
